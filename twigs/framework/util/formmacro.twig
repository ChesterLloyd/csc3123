{% macro hv(attr, value)%}
{% if value != '' %} {{attr}}="{{value}}"{% endif %}
{% endmacro hv %}

{% macro hvd(attr, value, dflt)%}
{{attr}}="{{value != '' ?: dflt}}"{% endif %}
{% endmacro hvd %}

{% macro cd(cond, attr, value) %}
{% if cond %} {{attr}}="{{value}}"{% endif %}
{% endmacro cd %}

{% macro cd(cond, attr, value, dflt) %}
{% import _self as h %}
{% if cond %}{{h.hv(attr, value, dflt)}}{% endif %}
{% endmacro cdd %}

{% macro fv(opts)%}
{% import _self as h %}
{% for v in ['required', 'disabled', 'readonly'] %}{{h.cv(opts[v], v, v)}}{% endfor %}
{% endmacro fv %}

{% macro cv(value)%}
 class="form-control{{value != '' ? ' '~value}}"
{% endmacro cv %}

{% macro data(opts) %}
{% for k,v in opts %} data-{{k}}{{v != '' ? '="'~v~'"'}}{% endfor %}
{% endmacro data %}

{% macro parsley(opts) %}
{% for k,v in opts %} data-parsley-{{k}}{{v != '' ? '="'~v~'"'}}{% endfor %}
{% endmacro parsley %}

{% macro input(type, opts) %}
{% import _self as h %}
<input type="{{type}}"{{h.hv('id', opts.id)}}{{h.fv(opts)}}{{h.hv('name', opts.name)}}{{h.hv('value', opts.value)}}{{h.cv(opts.class)}}{{h.hv('placeholder', opts.ph)}}{{h.data(opts.data)}}{{h.parsley(opts.parsley)}}/>
{% endmacro input %}

{% macro bsl(opts) %}
{% import _self as h %}
   <div class="form-group">
        {% if opts.label != '' %}
            <label{{h.hv('for', opts.id)}}>{{opts.label}}</label>
        {% endif %}
{% endmacro bsl %}

{% macro xsl(opts, cls) %}
{% import _self as h %}
   <div class="{{cls}}">
        {% if opts.label != '' %}
            <label{{h.hv('for', opts.id)}}>{{opts.label}}</label>
        {% endif %}
{% endmacro xsl %}

{% macro bse(opts) %}
        {% if opts.warn != '' %}
	    <span class="help-inline {{opts.warnc}}">{{opts.warn}}</span>
        {% endif %}
   </div>
{% endmacro bse%}

{% macro text(opts) %}
{% import _self as h %}
    {{h.bsl(opts)}}
    {{h.input('text', opts)}}
    {{h.bse(opts)}}
{% endmacro %}

{% macro email(opts) %}
{% import _self as h %}
    {{h.bsl(opts)}}
    {{h.input('email', opts)}}
    {{h.bse(opts)}}
{% endmacro %}

{% macro password(opts) %}
{% import _self as h %}
    {{h.bsl(opts)}}
    {{h.input('password', opts)}}
    {{h.bse(opts)}}
{% endmacro %}

{% macro hidden(opts) %}
{% import _self as h %}
    {{h.input('hidden', opts)}}
{% endmacro %}

{% macro checkbox(opts) %}
{% import _self as h %}
    {{h.xsl(opts, 'form-check form-check-inline')}}
    {% for ix,val in opts.values %}
        <label class="form-check-label mr-2">
	    <input type="checkbox" value="{{val}}"{{h.cd(opts.names[ix] is defined, 'name', opts.names[ix])}}{{h.hv('class', opts.class)}}{{h.data(opts.data)}}{{h.cd(opts.ids[ix] is defined, 'id', opts.ids[ix])}}{{h.cd(opts.check[ix] is defined and opts.check[ix], 'checked', 'checked')}}/>
        {{opts.labels[ix]|raw}}
        </label>
    {% endfor %}
    {{h.bse(opts)}}
{% endmacro %}

{% macro radio(opts) %}
{% import _self as h %}
    {{h.xsl(opts, 'form-check form-check-inline')}}
    {% for ix,val in opts.values %}
        <label class="form-check-label mr-2">
	    <input type="radio" value="{{val}}"{{h.cd(opts.name is defined, 'name', opts.name)}}{{h.cd(opts.names[ix] is defined, 'name', opts.names[ix])}}{{h.hv('class', opts.class)}}{{h.data(opts.data)}}{{h.cd(opts.ids[ix] is defined, 'id', opts.ids[ix])}}{{h.cd(opts.check[ix] is defined and opts.check[ix], 'checked', 'checked')}}/>
        {{opts.labels[ix]|raw}}
        </label>
    {% endfor %}
    {{h.bse(opts)}}
{% endmacro %}

{% macro textarea(opts) %}
{% import _self as h %}
    {{h.bsl(opts)}}
    <textarea{{h.hv('id', opts.id)}}{{h.fv(opts)}}{{h.hv('name', opts.name)}}{{h.cv(opts.class)}}{{h.hv('placeholder', opts.ph)}}{{h.data(opts.data)}}>{{opts.value}}</textarea>
    {{h.bse(opts)}}
{% endmacro %}

{% macro file(opts) %}
{% import _self as h %}
    {{h.bsl(opts)}}
    {{h.input('file', opts)}}
    {{h.bse(opts)}}
{% endmacro file %}

{% macro datetime(opts) %}
{% import _self as h %}
    {{h.bsl(opts)}}
    {{h.input('datetime', opts)}}
    {{h.bse(opts)}}
{% endmacro datetime %}

{% macro select(opts) %}
{% import _self as h %}
    {{h.bsl(opts)}}
    <select class="form-control"{{h.hv('id', opts.id)}}{{h.hv('name', opts.name)}}{{h.fv(opts)}}>
        {% for ov in opts.options %}
            <option value="{{ov.value}}"{% if opts.selected == ov.value %} selected="selected"{% endif %}>{{ov.text|raw}}</option>
        {% endfor %}
        </select>
    {{h.bse(opts)}}
{% endmacro select %}

{% macro submit(opts) %}
{% import _self as h %}
    <input class="btn {{opts.style != '' ?: 'btn-primary'}}" type="submit" value="{{opts.value}}"{{h.hv('id', opts.id)}}/>
{% endmacro submit %}

{% macro recaptcha(key, label, callback, opts) %}
{% import _self as h %}
    {% if key != '' %}
        <button class="btn {{opts.style != '' ?: 'btn-primary'}} g-recaptcha" data-sitekey="{{key}}" data-callback="{{callback}}"{{h.hv('id', opts.id)}}>{{label}}</button>
    {% else %}
        <button class="btn {{opts.style != '' ?: 'btn-primary'}}" onclick="{{callback}}('');"{{h.hv('id', opts.id)}}>{{label}}</button>        
    {% endif %}
{% endmacro recaptcha %}
